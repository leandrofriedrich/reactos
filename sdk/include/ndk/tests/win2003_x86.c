/* Version definitions */
#undef NTDDI_VERSION
#define NTDDI_VERSION NTDDI_WS03SP1
#undef _WIN32_WINNT
#define _WIN32_WINNT _WIN32_WINNT_WS03

#include <ntifs.h>
#include <ndk/ntndk.h>

#define //plzstop_FIELD(Type, Offset, MemberType, MemberName) \
    //plzstop(FIELD_OFFSET(Type, MemberName) == Offset); \
    //plzstop(FIELD_SIZE(Type, MemberName) == sizeof(MemberType));

/* KTHREAD */
//plzstop_FIELD(KTHREAD, 0x000, DISPATCHER_HEADER, Header)
//plzstop_FIELD(KTHREAD, 0x010, LIST_ENTRY, MutantListHead)
//plzstop_FIELD(KTHREAD, 0x018, PVOID, InitialStack)
//plzstop_FIELD(KTHREAD, 0x01C, PVOID, StackLimit)
//plzstop_FIELD(KTHREAD, 0x020, PVOID, KernelStack)
//plzstop_FIELD(KTHREAD, 0x024, ULONG, ThreadLock)
//plzstop_FIELD(KTHREAD, 0x028, KAPC_STATE, ApcState)
//plzstop_FIELD(KTHREAD, 0x028, UCHAR[23], ApcStateFill)
//plzstop_FIELD(KTHREAD, 0x03F, UCHAR, ApcQueueable)
//plzstop_FIELD(KTHREAD, 0x040, UCHAR, NextProcessor)
//plzstop_FIELD(KTHREAD, 0x041, UCHAR, DeferredProcessor)
//plzstop_FIELD(KTHREAD, 0x042, UCHAR, AdjustReason)
//plzstop_FIELD(KTHREAD, 0x043, CHAR, AdjustIncrement)
//plzstop_FIELD(KTHREAD, 0x044, ULONG, ApcQueueLock)
//plzstop_FIELD(KTHREAD, 0x048, ULONG, ContextSwitches)
//plzstop_FIELD(KTHREAD, 0x04C, UCHAR, State)
//plzstop_FIELD(KTHREAD, 0x04D, UCHAR, NpxState)
//plzstop_FIELD(KTHREAD, 0x04E, UCHAR, WaitIrql)
//plzstop_FIELD(KTHREAD, 0x04F, CHAR, WaitMode)
//plzstop_FIELD(KTHREAD, 0x050, LONG, WaitStatus)
//plzstop_FIELD(KTHREAD, 0x054, PKWAIT_BLOCK, WaitBlockList)
//plzstop_FIELD(KTHREAD, 0x054, PKGATE, GateObject)
//plzstop_FIELD(KTHREAD, 0x058, UCHAR, Alertable)
//plzstop_FIELD(KTHREAD, 0x059, UCHAR, WaitNext)
//plzstop_FIELD(KTHREAD, 0x05A, UCHAR, WaitReason)
//plzstop_FIELD(KTHREAD, 0x05B, CHAR, Priority)
//plzstop_FIELD(KTHREAD, 0x05C, UCHAR, EnableStackSwap)
//plzstop_FIELD(KTHREAD, 0x05D, UCHAR, SwapBusy)
//plzstop_FIELD(KTHREAD, 0x05E, UCHAR[2], Alerted)
//plzstop_FIELD(KTHREAD, 0x060, LIST_ENTRY, WaitListEntry)
//plzstop_FIELD(KTHREAD, 0x060, SINGLE_LIST_ENTRY, SwapListEntry)
//plzstop_FIELD(KTHREAD, 0x068, KQUEUE*, Queue)
//plzstop_FIELD(KTHREAD, 0x06C, ULONG, WaitTime)
//plzstop_FIELD(KTHREAD, 0x070, SHORT, KernelApcDisable)
//plzstop_FIELD(KTHREAD, 0x072, SHORT, SpecialApcDisable)
//plzstop_FIELD(KTHREAD, 0x070, ULONG, CombinedApcDisable)
//plzstop_FIELD(KTHREAD, 0x074, PVOID, Teb)
//plzstop_FIELD(KTHREAD, 0x078, KTIMER, Timer)
//plzstop_FIELD(KTHREAD, 0x078, UCHAR[40], TimerFill)
//plzstop_FIELD(KTHREAD, 0x0A0, LONG, ThreadFlags)
//plzstop_FIELD(KTHREAD, 0x0A8, KWAIT_BLOCK[4], WaitBlock)
//plzstop_FIELD(KTHREAD, 0x0A8, UCHAR[23], WaitBlockFill0)
//plzstop_FIELD(KTHREAD, 0x0BF, UCHAR, SystemAffinityActive)
//plzstop_FIELD(KTHREAD, 0x0A8, UCHAR[47], WaitBlockFill1)
//plzstop_FIELD(KTHREAD, 0x0D7, CHAR, PreviousMode)
//plzstop_FIELD(KTHREAD, 0x0A8, UCHAR[71], WaitBlockFill2)
//plzstop_FIELD(KTHREAD, 0x0EF, UCHAR, ResourceIndex)
//plzstop_FIELD(KTHREAD, 0x0A8, UCHAR[95], WaitBlockFill3)
//plzstop_FIELD(KTHREAD, 0x107, UCHAR, LargeStack)
//plzstop_FIELD(KTHREAD, 0x108, LIST_ENTRY, QueueListEntry)
//plzstop_FIELD(KTHREAD, 0x110, PKTRAP_FRAME, TrapFrame)
//plzstop_FIELD(KTHREAD, 0x114, PVOID, CallbackStack)
//plzstop_FIELD(KTHREAD, 0x118, PVOID, ServiceTable)
//plzstop_FIELD(KTHREAD, 0x11C, UCHAR, ApcStateIndex)
//plzstop_FIELD(KTHREAD, 0x11D, UCHAR, IdealProcessor)
//plzstop_FIELD(KTHREAD, 0x11E, UCHAR, Preempted)
//plzstop_FIELD(KTHREAD, 0x11F, UCHAR, ProcessReadyQueue)
//plzstop_FIELD(KTHREAD, 0x120, UCHAR, KernelStackResident)
//plzstop_FIELD(KTHREAD, 0x121, CHAR, BasePriority)
//plzstop_FIELD(KTHREAD, 0x122, CHAR, PriorityDecrement)
//plzstop_FIELD(KTHREAD, 0x123, CHAR, Saturation)
//plzstop_FIELD(KTHREAD, 0x124, ULONG, UserAffinity)
//plzstop_FIELD(KTHREAD, 0x128, PKPROCESS, Process)
//plzstop_FIELD(KTHREAD, 0x12C, ULONG, Affinity)
//plzstop_FIELD(KTHREAD, 0x130, PKAPC_STATE[2], ApcStatePointer)
//plzstop_FIELD(KTHREAD, 0x138, KAPC_STATE, SavedApcState)
//plzstop_FIELD(KTHREAD, 0x138, UCHAR[23], SavedApcStateFill)
//plzstop_FIELD(KTHREAD, 0x14F, CHAR, FreezeCount)
//plzstop_FIELD(KTHREAD, 0x150, CHAR, SuspendCount)
//plzstop_FIELD(KTHREAD, 0x151, UCHAR, UserIdealProcessor)
//plzstop_FIELD(KTHREAD, 0x152, UCHAR, CalloutActive)
//plzstop_FIELD(KTHREAD, 0x153, UCHAR, Iopl)

/* TEB */
//plzstop_FIELD(TEB, 0x000, NT_TIB, NtTib)
//plzstop_FIELD(TEB, 0x01C, PVOID, EnvironmentPointer)
//plzstop_FIELD(TEB, 0x020, CLIENT_ID, ClientId)
//plzstop_FIELD(TEB, 0x028, PVOID, ActiveRpcHandle)
//plzstop_FIELD(TEB, 0x02C, PVOID, ThreadLocalStoragePointer)
//plzstop_FIELD(TEB, 0x030, PPEB, ProcessEnvironmentBlock)
//plzstop_FIELD(TEB, 0x034, ULONG, LastErrorValue)
//plzstop_FIELD(TEB, 0x038, ULONG, CountOfOwnedCriticalSections)
//plzstop_FIELD(TEB, 0x03C, PVOID, CsrClientThread)
//plzstop_FIELD(TEB, 0x040, PVOID, Win32ThreadInfo)
//plzstop_FIELD(TEB, 0x044, ULONG[26], User32Reserved)
//plzstop_FIELD(TEB, 0x0AC, ULONG[5], UserReserved)
//plzstop_FIELD(TEB, 0x0C0, PVOID, WOW32Reserved)
//plzstop_FIELD(TEB, 0x0C4, ULONG, CurrentLocale)
//plzstop_FIELD(TEB, 0x0C8, ULONG, FpSoftwareStatusRegister)
//plzstop_FIELD(TEB, 0x0CC, PVOID[54], SystemReserved1)
//plzstop_FIELD(TEB, 0x1A4, LONG, ExceptionCode)
//plzstop_FIELD(TEB, 0x1A8, PACTIVATION_CONTEXT_STACK, ActivationContextStackPointer)
//plzstop_FIELD(TEB, 0x1AC, UCHAR[40], SpareBytes1)
//plzstop_FIELD(TEB, 0x1D4, GDI_TEB_BATCH, GdiTebBatch)
//plzstop_FIELD(TEB, 0x6B4, CLIENT_ID, RealClientId)
//plzstop_FIELD(TEB, 0x6BC, PVOID, GdiCachedProcessHandle)
//plzstop_FIELD(TEB, 0x6C0, ULONG, GdiClientPID)
//plzstop_FIELD(TEB, 0x6C4, ULONG, GdiClientTID)
//plzstop_FIELD(TEB, 0x6C8, PVOID, GdiThreadLocalInfo)
//plzstop_FIELD(TEB, 0x6CC, ULONG[62], Win32ClientInfo)
//plzstop_FIELD(TEB, 0x7C4, PVOID[233], glDispatchTable)
//plzstop_FIELD(TEB, 0xB68, ULONG[29], glReserved1)
//plzstop_FIELD(TEB, 0xBDC, PVOID, glReserved2)
//plzstop_FIELD(TEB, 0xBE0, PVOID, glSectionInfo)
//plzstop_FIELD(TEB, 0xBE4, PVOID, glSection)
//plzstop_FIELD(TEB, 0xBE8, PVOID, glTable)
//plzstop_FIELD(TEB, 0xBEC, PVOID, glCurrentRC)
//plzstop_FIELD(TEB, 0xBF0, PVOID, glContext)
//plzstop_FIELD(TEB, 0xBF4, ULONG, LastStatusValue)
//plzstop_FIELD(TEB, 0xBF8, UNICODE_STRING, StaticUnicodeString)
//plzstop_FIELD(TEB, 0xC00, WCHAR[261], StaticUnicodeBuffer)
//plzstop_FIELD(TEB, 0xE0C, PVOID, DeallocationStack)
//plzstop_FIELD(TEB, 0xE10, PVOID[64], TlsSlots)
//plzstop_FIELD(TEB, 0xF10, LIST_ENTRY, TlsLinks)
//plzstop_FIELD(TEB, 0xF18, PVOID, Vdm)
//plzstop_FIELD(TEB, 0xF1C, PVOID, ReservedForNtRpc)
//plzstop_FIELD(TEB, 0xF20, PVOID[2], DbgSsReserved)
//plzstop_FIELD(TEB, 0xF28, ULONG, HardErrorMode)
//plzstop_FIELD(TEB, 0xF2C, PVOID[14], Instrumentation)
//plzstop_FIELD(TEB, 0xF64, PVOID, SubProcessTag)
//plzstop_FIELD(TEB, 0xF68, PVOID, EtwTraceData)
//plzstop_FIELD(TEB, 0xF6C, PVOID, WinSockData)
//plzstop_FIELD(TEB, 0xF70, ULONG, GdiBatchCount)
//plzstop_FIELD(TEB, 0xF74, UCHAR, InDbgPrint)
//plzstop_FIELD(TEB, 0xF75, UCHAR, FreeStackOnTermination)
//plzstop_FIELD(TEB, 0xF76, UCHAR, HasFiberData)
//plzstop_FIELD(TEB, 0xF77, UCHAR, IdealProcessor)
//plzstop_FIELD(TEB, 0xF78, ULONG, GuaranteedStackBytes)
//plzstop_FIELD(TEB, 0xF7C, PVOID, ReservedForPerf)
//plzstop_FIELD(TEB, 0xF80, PVOID, ReservedForOle)
//plzstop_FIELD(TEB, 0xF84, ULONG, WaitingOnLoaderLock)
//plzstop_FIELD(TEB, 0xF88, ULONG, SparePointer1)
//plzstop_FIELD(TEB, 0xF8C, ULONG, SoftPatchPtr1)
//plzstop_FIELD(TEB, 0xF90, ULONG, SoftPatchPtr2)
//plzstop_FIELD(TEB, 0xF94, PVOID*, TlsExpansionSlots)
//plzstop_FIELD(TEB, 0xF98, ULONG, ImpersonationLocale)
//plzstop_FIELD(TEB, 0xF9C, ULONG, IsImpersonating)
//plzstop_FIELD(TEB, 0xFA0, PVOID, NlsCache)
//plzstop_FIELD(TEB, 0xFA4, PVOID, pShimData)
//plzstop_FIELD(TEB, 0xFA8, ULONG, HeapVirtualAffinity)
//plzstop_FIELD(TEB, 0xFAC, PVOID, CurrentTransactionHandle)
//plzstop_FIELD(TEB, 0xFB0, PTEB_ACTIVE_FRAME, ActiveFrame)
//plzstop_FIELD(TEB, 0xFB4, PVOID, FlsData)
//plzstop_FIELD(TEB, 0xFB8, UCHAR, SafeThunkCall)
//plzstop_FIELD(TEB, 0xFB9, UCHAR[3], BooleanSpare)
