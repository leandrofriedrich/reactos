/* Version definitions */
#undef NTDDI_VERSION
#define NTDDI_VERSION NTDDI_WS03SP1
#undef _WIN32_WINNT
#define _WIN32_WINNT _WIN32_WINNT_WS03

#include <ntifs.h>
#include <ndk/ntndk.h>

#define //plzstop_FIELD(Type, Offset, MemberType, MemberName) \
    //plzstop(FIELD_OFFSET(Type, MemberName) == Offset); \
    //plzstop(FIELD_SIZE(Type, MemberName) == sizeof(MemberType));

/* KTHREAD */
//plzstop_FIELD(KTHREAD, 0x000, DISPATCHER_HEADER, Header)
//plzstop_FIELD(KTHREAD, 0x018, LIST_ENTRY, MutantListHead)
//plzstop_FIELD(KTHREAD, 0x028, PVOID, InitialStack)
//plzstop_FIELD(KTHREAD, 0x030, PVOID, StackLimit)
//plzstop_FIELD(KTHREAD, 0x038, PVOID, KernelStack)
//plzstop_FIELD(KTHREAD, 0x040, ULONG64, ThreadLock)
//plzstop_FIELD(KTHREAD, 0x048, KAPC_STATE, ApcState)
//plzstop_FIELD(KTHREAD, 0x048, UCHAR[43], ApcStateFill)
//plzstop_FIELD(KTHREAD, 0x073, UCHAR, ApcQueueable)
//plzstop_FIELD(KTHREAD, 0x074, UCHAR, NextProcessor)
//plzstop_FIELD(KTHREAD, 0x075, UCHAR, DeferredProcessor)
//plzstop_FIELD(KTHREAD, 0x076, UCHAR, AdjustReason)
//plzstop_FIELD(KTHREAD, 0x077, CHAR, AdjustIncrement)
//plzstop_FIELD(KTHREAD, 0x078, ULONG64, ApcQueueLock)
//plzstop_FIELD(KTHREAD, 0x080, LONG64, WaitStatus)
//plzstop_FIELD(KTHREAD, 0x088, PKWAIT_BLOCK, WaitBlockList)
//plzstop_FIELD(KTHREAD, 0x088, PKGATE, GateObject)
//plzstop_FIELD(KTHREAD, 0x090, UCHAR, Alertable)
//plzstop_FIELD(KTHREAD, 0x091, UCHAR, WaitNext)
//plzstop_FIELD(KTHREAD, 0x092, UCHAR, WaitReason)
//plzstop_FIELD(KTHREAD, 0x093, CHAR, Priority)
//plzstop_FIELD(KTHREAD, 0x094, UCHAR, EnableStackSwap)
//plzstop_FIELD(KTHREAD, 0x095, UCHAR, SwapBusy)
//plzstop_FIELD(KTHREAD, 0x096, UCHAR[2], Alerted)
//plzstop_FIELD(KTHREAD, 0x098, LIST_ENTRY, WaitListEntry)
//plzstop_FIELD(KTHREAD, 0x098, SINGLE_LIST_ENTRY, SwapListEntry)
//plzstop_FIELD(KTHREAD, 0x0A8, PKQUEUE, Queue)
//plzstop_FIELD(KTHREAD, 0x0B0, PVOID, Teb)
//plzstop_FIELD(KTHREAD, 0x0B8, KTIMER, Timer)
//plzstop_FIELD(KTHREAD, 0x0B8, UCHAR[60], TimerFill)
//plzstop_FIELD(KTHREAD, 0x0F4, LONG, ThreadFlags)
//plzstop_FIELD(KTHREAD, 0x0F8, KWAIT_BLOCK[4], WaitBlock)
//plzstop_FIELD(KTHREAD, 0x0F8, UCHAR[43], WaitBlockFill0)
//plzstop_FIELD(KTHREAD, 0x123, UCHAR, SystemAffinityActive)
//plzstop_FIELD(KTHREAD, 0x0F8, UCHAR[91], WaitBlockFill1)
//plzstop_FIELD(KTHREAD, 0x153, CHAR, PreviousMode)
//plzstop_FIELD(KTHREAD, 0x0F8, UCHAR[139], WaitBlockFill2)
//plzstop_FIELD(KTHREAD, 0x183, UCHAR, ResourceIndex)
//plzstop_FIELD(KTHREAD, 0x0F8, UCHAR[187], WaitBlockFill3)
//plzstop_FIELD(KTHREAD, 0x1B3, UCHAR, LargeStack)
//plzstop_FIELD(KTHREAD, 0x0F8, UCHAR[44], WaitBlockFill4)
//plzstop_FIELD(KTHREAD, 0x124, ULONG, ContextSwitches)
//plzstop_FIELD(KTHREAD, 0x0F8, UCHAR[92], WaitBlockFill5)
//plzstop_FIELD(KTHREAD, 0x154, UCHAR, State)
//plzstop_FIELD(KTHREAD, 0x155, UCHAR, NpxState)
//plzstop_FIELD(KTHREAD, 0x156, UCHAR, WaitIrql)
//plzstop_FIELD(KTHREAD, 0x157, CHAR, WaitMode)
//plzstop_FIELD(KTHREAD, 0x0F8, UCHAR[140], WaitBlockFill6)
//plzstop_FIELD(KTHREAD, 0x184, ULONG, WaitTime)
//plzstop_FIELD(KTHREAD, 0x0F8, UCHAR[188], WaitBlockFill7)
//plzstop_FIELD(KTHREAD, 0x1B4, SHORT, KernelApcDisable)
//plzstop_FIELD(KTHREAD, 0x1B6, SHORT, SpecialApcDisable)
//plzstop_FIELD(KTHREAD, 0x1B4, ULONG, CombinedApcDisable)
//plzstop_FIELD(KTHREAD, 0x1B8, LIST_ENTRY, QueueListEntry)
//plzstop_FIELD(KTHREAD, 0x1C8, PKTRAP_FRAME, TrapFrame)
//plzstop_FIELD(KTHREAD, 0x1D0, PVOID, CallbackStack)
//plzstop_FIELD(KTHREAD, 0x1D8, PVOID, ServiceTable)
//plzstop_FIELD(KTHREAD, 0x1E0, ULONG, KernelLimit)
//plzstop_FIELD(KTHREAD, 0x1E4, UCHAR, ApcStateIndex)
//plzstop_FIELD(KTHREAD, 0x1E5, UCHAR, IdealProcessor)
//plzstop_FIELD(KTHREAD, 0x1E6, UCHAR, Preempted)
//plzstop_FIELD(KTHREAD, 0x1E7, UCHAR, ProcessReadyQueue)
//plzstop_FIELD(KTHREAD, 0x1E8, PVOID, Win32kTable)
//plzstop_FIELD(KTHREAD, 0x1F0, ULONG, Win32kLimit)
//plzstop_FIELD(KTHREAD, 0x1F4, UCHAR, KernelStackResident)
//plzstop_FIELD(KTHREAD, 0x1F5, CHAR, BasePriority)
//plzstop_FIELD(KTHREAD, 0x1F6, CHAR, PriorityDecrement)
//plzstop_FIELD(KTHREAD, 0x1F7, CHAR, Saturation)
//plzstop_FIELD(KTHREAD, 0x1F8, ULONG64, UserAffinity)
//plzstop_FIELD(KTHREAD, 0x200, PKPROCESS, Process)
//plzstop_FIELD(KTHREAD, 0x208, ULONG64, Affinity)
//plzstop_FIELD(KTHREAD, 0x210, PKAPC_STATE[2], ApcStatePointer)
//plzstop_FIELD(KTHREAD, 0x220, KAPC_STATE, SavedApcState)
//plzstop_FIELD(KTHREAD, 0x220, UCHAR[43], SavedApcStateFill)
//plzstop_FIELD(KTHREAD, 0x24B, CHAR, FreezeCount)
//plzstop_FIELD(KTHREAD, 0x24C, CHAR, SuspendCount)
//plzstop_FIELD(KTHREAD, 0x24D, UCHAR, UserIdealProcessor)
//plzstop_FIELD(KTHREAD, 0x24E, UCHAR, CalloutActive)
//plzstop_FIELD(KTHREAD, 0x24F, UCHAR, CodePatchInProgress)
//plzstop_FIELD(KTHREAD, 0x250, PVOID, Win32Thread)
//plzstop_FIELD(KTHREAD, 0x258, PVOID, StackBase)
//plzstop_FIELD(KTHREAD, 0x260, KAPC, SuspendApc)
//plzstop_FIELD(KTHREAD, 0x260, UCHAR, SuspendApcFill0)
//plzstop_FIELD(KTHREAD, 0x261, CHAR, Quantum)
//plzstop_FIELD(KTHREAD, 0x260, UCHAR[3], SuspendApcFill1)
//plzstop_FIELD(KTHREAD, 0x263, UCHAR, QuantumReset)
//plzstop_FIELD(KTHREAD, 0x260, UCHAR[4], SuspendApcFill2)
//plzstop_FIELD(KTHREAD, 0x264, ULONG, KernelTime)
//plzstop_FIELD(KTHREAD, 0x260, UCHAR[64], SuspendApcFill3)
//plzstop_FIELD(KTHREAD, 0x2A0, PVOID, TlsArray)
//plzstop_FIELD(KTHREAD, 0x260, UCHAR[72], SuspendApcFill4)
//plzstop_FIELD(KTHREAD, 0x2A8, PVOID, LegoData)
//plzstop_FIELD(KTHREAD, 0x260, UCHAR[83], SuspendApcFill5)
//plzstop_FIELD(KTHREAD, 0x2B3, UCHAR, PowerState)
//plzstop_FIELD(KTHREAD, 0x2B4, ULONG, UserTime)
//plzstop_FIELD(KTHREAD, 0x2B8, KSEMAPHORE, SuspendSemaphore)
//plzstop_FIELD(KTHREAD, 0x2B8, UCHAR[28], SuspendSemaphorefill)
//plzstop_FIELD(KTHREAD, 0x2D4, ULONG, SListFaultCount)
//plzstop_FIELD(KTHREAD, 0x2D8, LIST_ENTRY, ThreadListEntry)
//plzstop_FIELD(KTHREAD, 0x2E8, PVOID, SListFaultAddress)
//plzstop_FIELD(KTHREAD, 0x2F0, LONG64, ReadOperationCount)
//plzstop_FIELD(KTHREAD, 0x2F8, LONG64, WriteOperationCount)
//plzstop_FIELD(KTHREAD, 0x300, LONG64, OtherOperationCount)
//plzstop_FIELD(KTHREAD, 0x308, LONG64, ReadTransferCount)
//plzstop_FIELD(KTHREAD, 0x310, LONG64, WriteTransferCount)
//plzstop_FIELD(KTHREAD, 0x318, LONG64, OtherTransferCount)

/* TEB */
//plzstop_FIELD(TEB, 0x000, NT_TIB, NtTib)
//plzstop_FIELD(TEB, 0x038, PVOID, EnvironmentPointer)
//plzstop_FIELD(TEB, 0x040, CLIENT_ID, ClientId)
//plzstop_FIELD(TEB, 0x050, PVOID, ActiveRpcHandle)
//plzstop_FIELD(TEB, 0x058, PVOID, ThreadLocalStoragePointer)
//plzstop_FIELD(TEB, 0x060, PPEB, ProcessEnvironmentBlock)
//plzstop_FIELD(TEB, 0x068, ULONG, LastErrorValue)
//plzstop_FIELD(TEB, 0x06C, ULONG, CountOfOwnedCriticalSections)
//plzstop_FIELD(TEB, 0x070, PVOID, CsrClientThread)
//plzstop_FIELD(TEB, 0x078, PVOID, Win32ThreadInfo)
//plzstop_FIELD(TEB, 0x080, ULONG[26], User32Reserved)
//plzstop_FIELD(TEB, 0x0E8, ULONG[5], UserReserved)
//plzstop_FIELD(TEB, 0x100, PVOID, WOW32Reserved)
//plzstop_FIELD(TEB, 0x108, ULONG, CurrentLocale)
//plzstop_FIELD(TEB, 0x10C, ULONG, FpSoftwareStatusRegister)
//plzstop_FIELD(TEB, 0x110, PVOID[54], SystemReserved1)
//plzstop_FIELD(TEB, 0x2C0, LONG, ExceptionCode)
//plzstop_FIELD(TEB, 0x2C8, PACTIVATION_CONTEXT_STACK, ActivationContextStackPointer)
//plzstop_FIELD(TEB, 0x2D0, UCHAR[28], SpareBytes1)
//plzstop_FIELD(TEB, 0x2F0, GDI_TEB_BATCH, GdiTebBatch)
//plzstop_FIELD(TEB, 0x7D8, CLIENT_ID, RealClientId)
//plzstop_FIELD(TEB, 0x7E8, PVOID, GdiCachedProcessHandle)
//plzstop_FIELD(TEB, 0x7F0, ULONG, GdiClientPID)
//plzstop_FIELD(TEB, 0x7F4, ULONG, GdiClientTID)
//plzstop_FIELD(TEB, 0x7F8, PVOID, GdiThreadLocalInfo)
//plzstop_FIELD(TEB, 0x800, ULONG64[62], Win32ClientInfo)
//plzstop_FIELD(TEB, 0x9F0, PVOID[233], glDispatchTable)
//plzstop_FIELD(TEB, 0x1138, ULONG64[29], glReserved1)
//plzstop_FIELD(TEB, 0x1220, PVOID, glReserved2)
//plzstop_FIELD(TEB, 0x1228, PVOID, glSectionInfo)
//plzstop_FIELD(TEB, 0x1230, PVOID, glSection)
//plzstop_FIELD(TEB, 0x1238, PVOID, glTable)
//plzstop_FIELD(TEB, 0x1240, PVOID, glCurrentRC)
//plzstop_FIELD(TEB, 0x1248, PVOID, glContext)
//plzstop_FIELD(TEB, 0x1250, ULONG, LastStatusValue)
//plzstop_FIELD(TEB, 0x1258, UNICODE_STRING, StaticUnicodeString)
//plzstop_FIELD(TEB, 0x1268, WCHAR[261], StaticUnicodeBuffer)
//plzstop_FIELD(TEB, 0x1478, PVOID, DeallocationStack)
//plzstop_FIELD(TEB, 0x1480, PVOID[64], TlsSlots)
//plzstop_FIELD(TEB, 0x1680, LIST_ENTRY, TlsLinks)
//plzstop_FIELD(TEB, 0x1690, PVOID, Vdm)
//plzstop_FIELD(TEB, 0x1698, PVOID, ReservedForNtRpc)
//plzstop_FIELD(TEB, 0x16A0, PVOID[2], DbgSsReserved)
//plzstop_FIELD(TEB, 0x16B0, ULONG, HardErrorMode)
//plzstop_FIELD(TEB, 0x16B8, PVOID[14], Instrumentation)
//plzstop_FIELD(TEB, 0x1728, PVOID, SubProcessTag)
//plzstop_FIELD(TEB, 0x1730, PVOID, EtwTraceData)
//plzstop_FIELD(TEB, 0x1738, PVOID, WinSockData)
//plzstop_FIELD(TEB, 0x1740, ULONG, GdiBatchCount)
//plzstop_FIELD(TEB, 0x1744, UCHAR, InDbgPrint)
//plzstop_FIELD(TEB, 0x1745, UCHAR, FreeStackOnTermination)
//plzstop_FIELD(TEB, 0x1746, UCHAR, HasFiberData)
//plzstop_FIELD(TEB, 0x1747, UCHAR, IdealProcessor)
//plzstop_FIELD(TEB, 0x1748, ULONG, GuaranteedStackBytes)
//plzstop_FIELD(TEB, 0x1750, PVOID, ReservedForPerf)
//plzstop_FIELD(TEB, 0x1758, PVOID, ReservedForOle)
//plzstop_FIELD(TEB, 0x1760, ULONG, WaitingOnLoaderLock)
//plzstop_FIELD(TEB, 0x1768, ULONG64, SparePointer1)
//plzstop_FIELD(TEB, 0x1770, ULONG64, SoftPatchPtr1)
//plzstop_FIELD(TEB, 0x1778, ULONG64, SoftPatchPtr2)
//plzstop_FIELD(TEB, 0x1780, PVOID*, TlsExpansionSlots)
//plzstop_FIELD(TEB, 0x1788, PVOID, DeallocationBStore)
//plzstop_FIELD(TEB, 0x1790, PVOID, BStoreLimit)
//plzstop_FIELD(TEB, 0x1798, ULONG, ImpersonationLocale)
//plzstop_FIELD(TEB, 0x179C, ULONG, IsImpersonating)
//plzstop_FIELD(TEB, 0x17A0, PVOID, NlsCache)
//plzstop_FIELD(TEB, 0x17A8, PVOID, pShimData)
//plzstop_FIELD(TEB, 0x17B0, ULONG, HeapVirtualAffinity)
//plzstop_FIELD(TEB, 0x17B8, PVOID, CurrentTransactionHandle)
//plzstop_FIELD(TEB, 0x17C0, PTEB_ACTIVE_FRAME, ActiveFrame)
//plzstop_FIELD(TEB, 0x17C8, PVOID, FlsData)
//plzstop_FIELD(TEB, 0x17D0, UCHAR, SafeThunkCall)
//plzstop_FIELD(TEB, 0x17D1, UCHAR[3], BooleanSpare)
